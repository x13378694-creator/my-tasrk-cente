<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>æŒ‡æŒ¥éƒ¨ v6.1 | æ•°æ®ç¡¬æ ¸æ³¨å…¥ç‰ˆ</title>
    <script src="https://cdn.staticfile.org/tailwindcss/3.3.5/tailwind.min.js"></script>
    <script src="https://cdn.staticfile.org/marked/9.1.2/marked.min.js"></script>
    
    <style>
        body { background-color: #0D0D0D; color: #F3F4F6; height: 100vh; overflow: hidden; font-family: sans-serif; }
        .bento-card { background: #1A1A1A; border: 1px solid #2D2D2D; transition: all 0.3s ease; }
        .add-icon { 
            width: 24px; height: 24px; border-radius: 50%; background: #333; color: #A855F7; 
            display: flex; align-items: center; justify-content: center; font-weight: bold; cursor: pointer;
        }
        .add-icon:hover { background: #A855F7; color: white; }
        .tab-active { color: #A855F7; border-bottom: 2px solid #A855F7; }
        .tab-inactive { color: #666; }
        ::-webkit-scrollbar { width: 4px; }
        ::-webkit-scrollbar-thumb { background: #333; border-radius: 10px; }
    </style>
</head>
<body class="flex flex-col">

    <nav class="p-3 border-b border-gray-800 flex justify-between items-center bg-[#111] z-50">
        <div class="flex items-center gap-2">
            <h1 class="text-xs font-black tracking-widest text-purple-500">TASK_HQ_6.1</h1>
        </div>
        <div class="text-[10px] text-gray-500">ç¦»çº¿æ¨¡å¼</div>
    </nav>

    <main class="flex-1 flex flex-col md:flex-row p-2 gap-2 overflow-hidden">
        <section class="w-full md:w-1/3 bento-card rounded-xl p-3 flex flex-col overflow-hidden">
            <div class="flex justify-between items-center mb-3 border-b border-gray-800 pb-2">
                <span class="text-[10px] font-bold text-gray-500">ä»»åŠ¡åˆ—è¡¨</span>
                <div onclick="addTask()" class="add-icon" title="æ–°å»ºä»»åŠ¡">ï¼‹</div>
            </div>
            <div id="list" class="flex-1 overflow-y-auto space-y-2"></div>
        </section>

        <section class="flex-1 flex flex-col gap-2 overflow-hidden">
            <div class="bento-card rounded-xl p-4 flex-1 flex flex-col relative">
                <div class="flex justify-between items-start mb-2">
                    <input type="text" id="task-title" onchange="updateTitle()" class="bg-transparent text-xl font-bold text-white outline-none w-full" placeholder="é€‰æ‹©ä»»åŠ¡...">
                    <span id="prog-num" class="text-2xl font-black text-purple-500 opacity-20">0%</span>
                </div>
                
                <div class="flex items-center gap-2 mb-4">
                    <input type="time" id="task-time" onchange="saveData()" class="bg-gray-900 text-[10px] text-gray-400 border border-gray-700 rounded px-1">
                    <span class="text-[10px] text-gray-600">æ¯æ—¥æé†’</span>
                </div>

                <div class="w-full h-1 bg-gray-800 rounded-full mb-4 overflow-hidden">
                    <div id="prog-bar" class="h-full bg-purple-500 transition-all duration-500" style="width: 0%"></div>
                </div>

                <div id="subs" class="flex-1 overflow-y-auto space-y-2 mb-2"></div>
                
                <div class="flex gap-2 mt-auto">
                    <input id="sub-input" placeholder="æ·»åŠ æ­¥éª¤..." class="flex-1 bg-white/5 border border-gray-800 rounded p-2 text-sm text-white outline-none">
                    <button onclick="addSub()" class="bg-purple-600 text-white px-4 rounded text-sm font-bold">æ·»åŠ </button>
                </div>
            </div>

            <div class="bento-card rounded-xl p-3 h-1/3 flex flex-col">
                <div class="flex gap-4 border-b border-gray-800 pb-2 mb-2 text-[10px] font-bold">
                    <button onclick="setTab('sop')" id="btn-sop" class="tab-active">SOP æ”»ç•¥</button>
                    <button onclick="saveSop()" class="ml-auto text-purple-400">ä¿å­˜å†…å®¹</button>
                </div>
                
                <textarea id="sop-area" class="flex-1 bg-transparent text-xs text-gray-400 resize-none outline-none"></textarea>
                
                <div class="mt-2 flex justify-end">
                    <button onclick="forceRestore()" class="text-[10px] bg-red-900/30 text-red-500 px-3 py-1 rounded border border-red-500/30 hover:bg-red-900/50">
                        ğŸ†˜ ç‚¹æ­¤æ‰¾å›æˆ‘çš„ 5 æ¡æ•°æ®
                    </button>
                </div>
            </div>
        </section>
    </main>

    <script>
        // ä½ çš„åŸå§‹æ•°æ®ï¼Œå·²ç¡¬ç¼–ç åœ¨æ­¤
        const MY_DATA = [{"id":1769856578154,"title":"dankoeçš„åœ¨ä¸€å¤©å†…å½»åº•æ”¹å˜äººç”Ÿåˆ°åº•æœ‰å¤šå¼ºå¤§","subtasks":[],"reminderTime":"","lastReminderDate":"","sop":"","reflection":"","completed":false},{"id":1769855581999,"title":"åšä¸€ä¸ªæ¯æ—¥æé†’dankoeå†™çš„é—®é¢˜æé†’ï¼Œå¹¶ä¸”æœ‰å¿ƒå¾—ä½“ä¼šå›ç­”çš„é‚£ç§ï¼Œæ¯å¤©éƒ½å¯ä»¥","subtasks":[],"reminderTime":"","lastReminderDate":"","sop":"","reflection":"","completed":false},{"id":1769850813071,"title":"æ¢æ¨ç‰¹å·ï¼Œå†™ä¸€ç¯‡å…³äºç…œå­æ˜¾åŒ–å’Œdanæ”¹å˜ä¸€å¤©çš„ç›¸è”ç³»çš„æ–‡ç« ï¼Œå‘è¡¨åˆ°æ¨ç‰¹ï¼Œå°çº¢ä¹¦ï¼Œå¾®ä¿¡å…¬ä¼—å·ï¼Œå¾®ä¿¡å…¬ä¼—å·å¸¦å¹¿å‘Š","subtasks":[],"reminderTime":"","lastReminderDate":"","sop":"","reflection":"","completed":false},{"id":1769786819936,"title":"å†™ä¸€ç¯‡å…¬ä¼—å·ç§è‰ï¼Œè¯é¢˜å¿˜è®°äº†","subtasks":[{"id":1769831964603,"text":"é€‰é¢˜","done":false},{"id":1769844089144,"text":"é€‰é¢˜ï¼šä¸ºä»€ä¹ˆè¯´ï¼Œaiæ—¶ä»£æˆ‘ä»¬çš„ä¼˜åŠ¿æ›´å¤šäº†ï¼Ÿä¸ºä»€ä¹ˆè¯´ï¼Œä¸ç”¨æ‹…å¿ƒaiæ›¿ä»£æˆ‘ä»¬ï¼Ÿaiæ—¶ä»£ï¼Œæˆ‘ä»¬å°±æ˜¯ä¼šè¢«æ›¿ä»£çš„ï¼Ÿ","done":false}],"reminderTime":"08:00","lastReminderDate":"","sop":"","reflection":"","completed":false},{"id":1769774974790,"title":"ç»ˆç‚¹ç³»ç»Ÿç½‘é¡µåˆ¶ä½œ","subtasks":[{"id":1769774994705,"text":"å»ºç«‹å¤§çº²","done":true},{"id":1769780006388,"text":"åšå®šè‡ªå·±çš„æƒ³æ³•ï¼Œä»»åŠ¡å†…å®¹å¿…é¡»è¦å…¨ï¼Œä¸€å®šè¦æ¯æ¡å¼ºè°ƒè‡ªå·±çš„æƒ³æ³•ï¼Œä¸è¦è¢«aiæ‰€å¸¦è·‘ï¼Œä¸è¦è®©aiçœåŠ²ã€‚","done":true},{"id":1769780063553,"text":"åˆ†äº«ç»™æœ‹å‹ï¼Œè®©ä»–ä»¬ä½“éªŒå¹¶ä¸”åé¦ˆç»§ç»­æ”¹è¿›ï¼Œä¸è¦å¿˜è®°è‡ªå·±æƒ³æ³•","done":true},{"id":1769785151601,"text":"å­¦ä¼šå¦‚ä½•åœ¨githubé‡Œé¢åšç½‘å€","done":true},{"id":1769785458872,"text":"åŠ å…¥ä½¿ç”¨æ‰‹å†Œ","done":true}],"reminderTime":"08:09","lastReminderDate":"","sop":"# ğŸ–ï¸ å…¨èƒ½å¼€å‘è€…ï¼šé¡¹ç›®å…¨ç”Ÿå‘½å‘¨æœŸä½œæˆ˜åè®® (v3.0)\n\n## é˜¶æ®µä¸€ï¼šå»ºç«‹å¤§çº² (The Skeleton)\n- **ç¡¬æ€§è¦æ±‚**ï¼šä¸¥ç¦ç›´æ¥è®© AI å¼€å·¥ã€‚å¿…é¡»å…ˆæ‰‹åŠ¨æ•²å®š 1, 2, 3 çº§åŠŸèƒ½å¤§çº²ã€‚\n- **ç›®æ ‡**ï¼šåœ¨ AI ä»‹å…¥å‰ï¼Œé€»è¾‘é˜µåœ°å¿…é¡»ç”±ä½ ç™¾åˆ†ä¹‹ç™¾å é¢†ã€‚\n\n## é˜¶æ®µäºŒï¼šæ„å¿—æå«ä¸å AI ç®€åŒ– (Integrity Guard) ğŸ›¡ï¸\n- **ä½œæˆ˜å‡†åˆ™**ï¼š\nÂ  Â  1. **å…¨é‡æ‰«æ**ï¼šæ¯ä¸€æ¡åŸå§‹æƒ³æ³•å¿…é¡»åœ¨ä»£ç ä¸­ä½“ç°ï¼ŒAI æ¼æ‰ä¸€æ¡ï¼Œç«‹åˆ»å‘½ä»¤é‡å†™ã€‚\nÂ  Â  2. **æ‹’ç»å·æ‡’**ï¼šçœ‹åˆ° `// code remains the same` æˆ–çœç•¥å·ï¼Œè§†ä¸º AI è¿è§„ï¼Œå¼ºåˆ¶è¦æ±‚å…¨é‡è¾“å‡ºã€‚\nÂ  Â  3. **ä¸»æƒå£°æ˜**ï¼šåœ¨ Prompt ä¸­æ˜ç¡®â€œæˆ‘æ˜¯æ¶æ„å¸ˆï¼Œä½ åªæ˜¯æ‰§è¡Œå™¨â€ã€‚\n\n## é˜¶æ®µä¸‰ï¼šç¤¾äº¤éªŒè¯ä¸åé¦ˆå¸æ”¶ (Social Testing)\n- **åŠ¨ä½œ**ï¼šå°†åŸå‹å‘ç»™æœ‹å‹ä½“éªŒã€‚\n- **åé¦ˆå¤„ç†**ï¼šè®°å½•æ‰€æœ‰åé¦ˆï¼Œä½†åªé‡‡çº³â€œä¸è¿èƒŒåˆè¡·â€çš„å»ºè®®ã€‚è®°ä½ï¼šä½ æ˜¯äº§å“çš„çµé­‚ã€‚\n\n## é˜¶æ®µå››ï¼šGitHub Pages è‡ªåŠ¨åŒ–éƒ¨ç½² (Deployment) ğŸŒ\n- **æµç¨‹**ï¼šæ–°å»º Repo -> ä¸Šä¼  `index.html` -> Settings å¼€å¯ Pages -> è·å¾—å…¨çƒå”¯ä¸€åŸŸåã€‚\n- **æ ‡å‡†**ï¼šéƒ¨ç½²åï¼Œå¿…é¡»åœ¨æ‰‹æœº Safari ä¸‹æµ‹è¯•â€œæ·»åŠ åˆ°ä¸»å±å¹•â€çš„å…¼å®¹æ€§ã€‚\n\n## é˜¶æ®µäº”ï¼šäº¤ä»˜ä»¶ï¼šç¼–å†™ä½¿ç”¨æ‰‹å†Œ (User Manual) ğŸ“˜\n- **æ ¸å¿ƒä»»åŠ¡**ï¼šä¸ºä½ å¼€å‘çš„è¿™ä¸ªæ–°å·¥å…·å†™ä¸€ä»½â€œç™½ç—´çº§â€ä½¿ç”¨æŒ‡å—ã€‚\n- **å¿…é¡»åŒ…å«**ï¼š\nÂ  Â  1. **æ ¸å¿ƒåŠŸèƒ½è¯´æ˜**ï¼šè¿™ä¸ªå·¥å…·æ˜¯å¹²ä»€ä¹ˆçš„ï¼Ÿ\nÂ  Â  2. **ç¯å¢ƒä¾èµ–**ï¼šéœ€è¦ä»€ä¹ˆæµè§ˆå™¨ï¼Ÿæ˜¯å¦éœ€è¦æˆæƒé€šçŸ¥ï¼Ÿ\nÂ  Â  3. **æ“ä½œæµç¨‹**ï¼šç¬¬ä¸€æ­¥ç‚¹å“ªé‡Œï¼Œç¬¬äºŒæ­¥æ€ä¹ˆåšã€‚\nÂ  Â  4. **æ•…éšœæ’é™¤**ï¼šå¦‚æœæ²¡ååº”ï¼Œåº”è¯¥æ£€æŸ¥å“ªé‡Œï¼ˆå¦‚æƒé™ã€ç¼“å­˜ç­‰ï¼‰ã€‚\n- **æ„ä¹‰**ï¼šæ‰‹å†Œæ˜¯é˜²æ­¢ç”¨æˆ·â€œè¯¯è¯»â€ä½ ä½œå“çš„æœ€åä¸€é“é˜²çº¿ã€‚","reflection":"","completed":false}];

        let tasks = [];
        let curId = null;

        window.onload = function() {
            // å°è¯•åŠ è½½æœ¬åœ°ï¼Œå¦‚æœæ²¡æœ‰åˆ™ä½¿ç”¨ç¡¬ç¼–ç æ•°æ®
            const oldData = localStorage.getItem('cmd_v61_data');
            if (oldData) {
                try { tasks = JSON.parse(oldData); } catch(e) { tasks = MY_DATA; }
            } else {
                tasks = MY_DATA; // é»˜è®¤åŠ è½½ä½ çš„æ•°æ®
            }
            
            // ç¡®ä¿æœ‰æ•°æ®
            if (tasks.length === 0) tasks = MY_DATA;

            renderList();
            if (tasks.length > 0) selectTask(tasks[0].id);
        };

        // å¼ºåˆ¶æ¢å¤æ•°æ®
        function forceRestore() {
            if(confirm("ç¡®å®šè¦é‡æ–°åŠ è½½ä½ çš„5æ¡åŸå§‹æ•°æ®å—ï¼Ÿè¿™å°†è¦†ç›–å½“å‰å˜åŠ¨ã€‚")) {
                tasks = MY_DATA;
                saveData();
                renderList();
                selectTask(tasks[0].id);
                alert("æ•°æ®å·²å¤æ´»ï¼");
            }
        }

        function saveData() {
            localStorage.setItem('cmd_v61_data', JSON.stringify(tasks));
        }

        function addTask() {
            const t = prompt("æ–°ä»»åŠ¡åç§°:");
            if (!t) return;
            const newId = Date.now();
            tasks.unshift({id: newId, title: t, subs: [], sop: "", reminderTime: ""});
            selectTask(newId);
            saveData(); renderList();
        }

        function renderList() {
            const el = document.getElementById('list');
            el.innerHTML = tasks.map(t => {
                const prog = calcProg(t);
                return `
                <div onclick="selectTask(${t.id})" class="p-2 mb-2 rounded border cursor-pointer ${t.id === curId ? 'bg-purple-900/20 border-purple-500' : 'border-gray-800 hover:bg-gray-800'}">
                    <div class="flex justify-between text-[10px] mb-1 text-gray-300">
                        <span class="font-bold truncate pr-2">${t.title}</span>
                        <span class="${prog===100?'text-green-500':'text-purple-500'}">${prog}%</span>
                    </div>
                    <div class="w-full h-[2px] bg-gray-800 rounded overflow-hidden">
                        <div class="bg-purple-500 h-full" style="width: ${prog}%"></div>
                    </div>
                </div>`;
            }).join('');
        }

        function selectTask(id) {
            curId = id;
            const t = tasks.find(x => x.id === id);
            if (!t) return;
            
            document.getElementById('task-title').value = t.title;
            document.getElementById('task-time').value = t.reminderTime || "";
            document.getElementById('sop-area').value = t.sop || "";
            
            renderSubs(); renderList();
        }

        function renderSubs() {
            const t = tasks.find(x => x.id === curId);
            const prog = calcProg(t);
            document.getElementById('prog-bar').style.width = prog + "%";
            document.getElementById('prog-num').innerText = prog + "%";
            
            document.getElementById('subs').innerHTML = t.subs.map((s, i) => `
                <div class="flex items-center gap-2 p-2 rounded hover:bg-white/5 cursor-pointer" onclick="toggleSub(${i})">
                    <div class="w-3 h-3 border border-gray-500 rounded flex items-center justify-center ${s.done ? 'bg-purple-500 border-purple-500' : ''}">
                        ${s.done ? '<span class="text-white text-[8px]">âœ“</span>' : ''}
                    </div>
                    <span class="text-xs ${s.done ? 'text-gray-600 line-through' : 'text-gray-300'}">${s.text || s.d}</span>
                </div>
            `).join('');
        }

        function addSub() {
            const val = document.getElementById('sub-input').value;
            if (!val) return;
            tasks.find(x => x.id === curId).subs.push({text: val, done: false});
            document.getElementById('sub-input').value = "";
            saveData(); renderSubs(); renderList();
        }

        function toggleSub(idx) {
            const t = tasks.find(x => x.id === curId);
            t.subs[idx].done = !t.subs[idx].done;
            saveData(); renderSubs(); renderList();
        }

        function updateTitle() {
            tasks.find(x => x.id === curId).title = document.getElementById('task-title').value;
            saveData(); renderList();
        }

        function saveSop() {
            tasks.find(x => x.id === curId).sop = document.getElementById('sop-area').value;
            saveData(); alert("SOP å·²ä¿å­˜");
        }

        function calcProg(t) {
            if (!t.subtasks && !t.subs) return 0;
            const s = t.subtasks || t.subs;
            if (s.length === 0) return 0;
            return Math.round(s.filter(i => i.done).length / s.length * 100);
        }

        function setTab(t) { /* å ä½ï¼Œä¿æŒç²¾ç®€ */ }
    </script>
</body>
</html>
